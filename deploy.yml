- name: "Automate running docker container with ansible"
  hosts: localhost
  tasks:
    - name: stop running container
      command: docker stop edu-city
      ignore_errors: yes

    - name: remove stopped container
      command: docker rm edu-city
      ignore_errors: yes

    - name: remove used image
      command: docker rmi edu-city-backend
      ignore_errors: yes

    - name: build docker image from dockerfile
      command: docker build -t edu-city-backend .

    - name: create tag to image
      command: docker tag edu-city-backend melbehery/edu-city-backend

    - name: push image to dockerhub
      command: docker push melbehery/edu-city-backend

    - name: run container from image
      command: docker run -d --name edu-city -p 5000:5000 edu-city-backend

